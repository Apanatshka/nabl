module generation/modules/module

imports

  libstrc
  signatures/modules/-
  generation/-
  generation/signatures/-

rules

  module-to-str:
    Module(name,section*) ->
      module-str
    with
      import-str := Imports([
        Import("nabl2shared"),
        Import("nabl2runtime")
      ]);
      pp-str := Rules([
      //SDefNoArgs("prettyprint-NaBL2-object", CallNoArgs(SVar($[prettyprint-[<language-spec-name>]-Type]))),
      //SDefNoArgs($[prettyprint-[<language-spec-name>]-Type], Fail())
      ]);
      nameresolution-str* := <sections-to-nameresolution-str> section*;
      section-str* := <mapconcat(section-to-str;(is-list<+MkSingleton))> section*;
      module-str := Module(name,[import-str,pp-str,nameresolution-str*,section-str*])

  language-spec-name = prim("SSL_EXT_language_spec_pp_name") <+ "unknown"

rules

  section-to-str:
    Imports(import*) -> Imports(import'*)
    with
      import'* := <map(import-to-str)> import*
  
  import-to-str:
    Import(_) -> <id>
    
  import-to-str:
    ImportWildcard(name) -> Import($[[name]/-])

