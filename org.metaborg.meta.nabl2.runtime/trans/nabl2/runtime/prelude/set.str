module nabl2/runtime/prelude/set

strategies
  
  dups = dups(eq)
  
  dups(eq): [x|x*] -> [d*|<dups(eq)> z*]
    where (y*,z*) := <partition(where(<eq> (x,<id>)))> x*
        ; if [] := y* then
            d* := []
          else
            d* := [x|y*]
          end
  dups(eq): [] -> []
  

  set-add(|x) = set-add(eq|x)

  set-add(eq|x): ys@[y|_] -> ys
    where <eq> (x,y)

  set-add(eq|x): [y|ys] -> [y|<set-add(eq|x)> ys]
    where <not(eq)> (x,y)

  set-add(eq|x): [] -> [x]
